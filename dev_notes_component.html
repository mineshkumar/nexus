<!-- Dev Notes Component - Include this in all pages for localhost development -->

<!-- Add these styles to your <style> tag -->
<style>
    /* Dev Notes Styles */
    .dev-notes-btn {
        position: fixed;
        bottom: 24px;
        right: 24px;
        width: 56px;
        height: 56px;
        border-radius: 50%;
        background: #f59e0b;
        color: white;
        border: none;
        box-shadow: 0 4px 12px rgba(245, 158, 11, 0.4);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s;
        z-index: 1000;
    }

    .dev-notes-btn:hover {
        transform: scale(1.1);
        box-shadow: 0 6px 16px rgba(245, 158, 11, 0.6);
    }

    .dev-notes-panel {
        position: fixed;
        top: 0;
        right: -400px;
        width: 400px;
        height: 100vh;
        background: white;
        box-shadow: -4px 0 20px rgba(0, 0, 0, 0.1);
        transition: right 0.3s ease;
        z-index: 999;
        display: flex;
        flex-direction: column;
    }

    .dark .dev-notes-panel {
        background: #171717;
        box-shadow: -4px 0 20px rgba(0, 0, 0, 0.5);
    }

    .dev-notes-panel.open {
        right: 0;
    }

    .dev-note-item {
        padding: 12px;
        border-bottom: 1px solid #f1f5f9;
        transition: background 0.2s;
    }

    .dark .dev-note-item {
        border-bottom: 1px solid #262626;
    }

    .dev-note-item:hover {
        background: #f8fafc;
    }

    .dark .dev-note-item:hover {
        background: #262626;
    }
</style>

<!-- Add this HTML before closing </body> tag -->
<button id="devNotesBtn" class="dev-notes-btn" onclick="toggleDevNotes()" style="display: none;">
    <i data-lucide="clipboard" class="w-6 h-6"></i>
</button>

<div id="devNotesPanel" class="dev-notes-panel">
    <div class="p-6 border-b border-gray-200 dark:border-neutral-800">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-lg font-semibold">Dev Notes</h2>
            <button onclick="toggleDevNotes()" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                <i data-lucide="x" class="w-5 h-5"></i>
            </button>
        </div>
        <div class="flex gap-2">
            <select id="noteType" class="text-sm border rounded px-2 py-1 dark:bg-neutral-800 dark:border-neutral-700">
                <option value="bug">üêõ Bug</option>
                <option value="feature">‚ú® Feature</option>
                <option value="note">üìù Note</option>
            </select>
            <input type="text" id="noteInput" placeholder="Quick note..."
                class="flex-1 text-sm border rounded px-3 py-1 outline-none dark:bg-neutral-800 dark:border-neutral-700"
                onkeypress="if(event.key === 'Enter') saveDevNote()">
            <button onclick="saveDevNote()" class="bg-amber-500 text-white px-3 py-1 rounded text-sm hover:bg-amber-600">
                Add
            </button>
        </div>
    </div>
    <div id="devNotesContainer" class="flex-1 overflow-y-auto"></div>
</div>

<!-- Add these functions to your <script> tag -->
<script>
    // Dev Notes Functions (only for localhost)
    function toggleDevNotes() {
        document.getElementById('devNotesPanel').classList.toggle('open');
    }

    async function saveDevNote() {
        const text = document.getElementById('noteInput').value.trim();
        const type = document.getElementById('noteType').value;
        if (!text) return;

        const page = window.location.pathname.split('/').pop() || 'index.html';
        const entry = {
            text,
            type,
            page,
            timestamp: new Date().toISOString()
        };

        await supabaseClient.from('dev_notes').insert([entry]);
        document.getElementById('noteInput').value = '';
        fetchDevNotes();
    }

    async function fetchDevNotes() {
        const { data, error } = await supabaseClient
            .from('dev_notes')
            .select('*')
            .order('timestamp', { ascending: false });

        if (!error && data) {
            renderDevNotes(data);
        }
    }

    function renderDevNotes(notes) {
        const container = document.getElementById('devNotesContainer');
        const typeEmoji = { bug: 'üêõ', feature: '‚ú®', note: 'üìù' };

        container.innerHTML = notes.map(note => `
            <div class="dev-note-item">
                <div class="flex justify-between items-start mb-1">
                    <span class="text-xs font-semibold text-amber-600 dark:text-amber-500">${typeEmoji[note.type]} ${note.type.toUpperCase()}</span>
                    <button onclick="deleteDevNote('${note.id}')" class="text-gray-300 hover:text-red-500 text-xs">
                        <i data-lucide="trash-2" class="w-3 h-3"></i>
                    </button>
                </div>
                <p class="text-sm text-gray-700 dark:text-gray-300 mb-1">${note.text}</p>
                <div class="flex gap-2 text-xs text-gray-400">
                    <span>${note.page}</span>
                    <span>‚Ä¢</span>
                    <span>${new Date(note.timestamp).toLocaleString()}</span>
                </div>
            </div>
        `).join('');
        lucide.createIcons();
    }

    async function deleteDevNote(id) {
        await supabaseClient.from('dev_notes').delete().eq('id', id);
        fetchDevNotes();
    }

    // Show dev notes button only on localhost (add after isLocalhost is defined)
    if (isLocalhost) {
        document.getElementById('devNotesBtn').style.display = 'flex';
        fetchDevNotes();
    }
</script>
